<%
include("/jagg/jagg.jag");
include("/jagg/constants.jag");
include("/jagg/config_reader.jag");

var log = new Log("site/blocks/billing/account/info/ajax/get.jag");
var carbon = require('carbon');
var server = carbon.server;

(function () {

	var loginStatus = jagg.isUserLoggedIn();
	if (loginStatus.error) {
		response.status = 401;
		print(loginStatus);
		return;
	}

	var action = request.getParameter("action");
	if((session.get("TENANT_INFO")) != null ){
		var tenantDomain = (session.get("TENANT_INFO")).tenantDomain;
		var billingService = server.osgiService('org.wso2.carbon.cloud.billing.service.CloudBillingService');
		var accountId = billingService.getAccountId(tenantDomain);
		var summary  = billingService.getAccountSummary(accountId);
		print(summary);
	}

}());
%>
